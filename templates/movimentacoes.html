{% extends "base.html" %}

{% block title %}Movimenta√ß√µes - SystemLR{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Movimenta√ß√µes</h1>
    <a href="{{ url_for('nova_movimentacao') }}" class="btn btn-primary">‚ûï Nova Movimenta√ß√£o</a>
</div>

<!-- FILTROS -->
<div class="filters-section">
    <form method="GET" class="filters-form">
        <div class="filter-group">
            <select name="produto_id" class="input-select">
                <option value="">Todos os produtos</option>
                {% for prod in produtos %}
                <option value="{{ prod.id }}" {% if produto_selecionado == prod.id %}selected{% endif %}>
                    {{ prod.nome }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="filter-group">
            <select name="tipo" class="input-select">
                <option value="">Todos os tipos</option>
                <option value="entrada" {% if tipo_selecionado == 'entrada' %}selected{% endif %}>üì• Entrada</option>
                <option value="saida" {% if tipo_selecionado == 'saida' %}selected{% endif %}>üì§ Sa√≠da</option>
            </select>
        </div>
        <button type="submit" class="btn btn-secondary">üîç Filtrar</button>
    </form>
</div>

<!-- LISTA DE MOVIMENTA√á√ïES -->
<div class="table-responsive">
    <table class="table">
        <thead>
            <tr>
                <th>Produto</th>
                <th>Tipo</th>
                <th>Quantidade</th>
                <th>Motivo</th>
                <th>Data</th>
            </tr>
        </thead>
        <tbody>
            {% for mov in movimentacoes %}
            <tr>
                <td data-label="Produto">
                    <a href="{{ url_for('visualizar_produto', produto_id=mov.produto_id) }}">{{ mov.produto.nome }}</a>
                </td>
                <td data-label="Tipo">
                    <span class="badge {% if mov.tipo == 'entrada' %}badge-success{% else %}badge-danger{% endif %}">
                        {% if mov.tipo == 'entrada' %}üì• Entrada{% else %}üì§ Sa√≠da{% endif %}
                    </span>
                </td>
                <td data-label="Quantidade">{{ mov.quantidade }}</td>
                <td data-label="Motivo">{{ mov.motivo or '-' }}</td>
                <td data-label="Data">{{ mov.criado_em.strftime('%d/%m/%Y %H:%M') }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="text-center">Nenhuma movimenta√ß√£o encontrada</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
